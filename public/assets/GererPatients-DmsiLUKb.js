import{c as f,m as c,e,h as _,t as n,j as d,v as u,F as O,D as H,i as E,H as M,g as i,r as b,E as A,o as L,n as v,B as R}from"./app-CaZ2Mw_6.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{U as K}from"./user-D2VY_H2T.js";import"./createLucideIcon-nmpOFqC6.js";const Q={__name:"GererPatients",props:{user:Object,users:{type:Array,required:!1,default:()=>[]}},setup(F,{expose:t}){t();const N=F,l=b(""),p=b(null),g=b(!1),s=b(null),x=b(!1),y=b(!1),h=b({firstName:"",lastName:"",phone:"",email:"",address:"",accountStatus:"active"}),m=b([...N.users]),j=A(()=>m.value.length),q=A(()=>l.value?m.value.filter(o=>{var r,k,a,U,V;return((r=o.lastName)==null?void 0:r.toLowerCase().includes(l.value.toLowerCase()))||((k=o.firstName)==null?void 0:k.toLowerCase().includes(l.value.toLowerCase()))||((a=o.phone)==null?void 0:a.toLowerCase().includes(l.value.toLowerCase()))||((U=o.email)==null?void 0:U.toLowerCase().includes(l.value.toLowerCase()))||((V=o.address)==null?void 0:V.toLowerCase().includes(l.value.toLowerCase()))}):m.value);let P=null,w=!1;async function C(){if(!w){w=!0;try{const o=await fetch("/patient",{cache:"no-cache"});if(!o.ok)throw new Error("Erreur API");const r=await o.json(),k=Array.isArray(r)?r:r.users||r.patients||[];m.value=k.map(a=>({...a,id:a.id,firstName:a.firstName||a.first_name||a.firstname,lastName:a.lastName||a.last_name||a.lastname,phone:a.phone||a.telephone,email:a.email,address:a.address||a.adresse,accountStatus:a.accountStatus||a.account_status,createdAt:a.createdAt||a.created_at,updatedAt:a.updatedAt||a.updated_at}))}catch(o){console.error("Fetch patients error:",o)}finally{w=!1}}}L(()=>{C(),P=setInterval(()=>{C()},4e4)}),onBeforeUnmount(()=>{clearInterval(P)});function D(o){p.value=p.value===o?null:o}function I(o){s.value={...o},g.value=!0,x.value=!1,p.value=null}function T(o){s.value={...o},g.value=!0,x.value=!0,p.value=null}function B(o){confirm("Supprimer "+o.lastName+" ?")&&(m.value=m.value.filter(r=>r.id!==o.id)),p.value=null}function G(){const o=m.value.findIndex(r=>r.id===s.value.id);o!==-1&&(m.value[o]={...s.value}),g.value=!1}function z(){const o={...h.value,id:Date.now()};m.value.push(o),y.value=!1,h.value={firstName:"",lastName:"",phone:"",email:"",address:"",accountStatus:"active"}}const S={props:N,search:l,openMenu:p,showDetails:g,selectedPatient:s,isEditing:x,showAddForm:y,addForm:h,patients:m,totalPatients:j,filteredPatients:q,get intervalId(){return P},set intervalId(o){P=o},get isFetching(){return w},set isFetching(o){w=o},fetchPatients:C,toggleMenu:D,voirPlus:I,modifier:T,supprimer:B,enregistrerModif:G,ajouterPatient:z,ref:b,computed:A,onMounted:L,get User(){return K}};return Object.defineProperty(S,"__isScriptSetup",{enumerable:!1,value:!0}),S}},W={class:"flex justify-between items-center mb-6"},X={class:"mt-2 flex items-center gap-4"},Y={class:"bg-white rounded shadow p-4 flex items-center gap-2"},Z={class:"font-bold text-2xl"},$={class:"flex items-center gap-4"},ee={class:"bg-white rounded shadow p-4"},te={class:"w-full text-left"},le={class:"py-2 px-2 font-bold"},se={class:"py-2 px-2"},oe={class:"py-2 px-2"},ne={class:"py-2 px-2"},ae={class:"py-2 px-2"},de={class:"py-2 px-2"},ie={class:"py-2 px-2 relative"},re=["onClick"],ue={key:0,class:"absolute right-0 mt-2 w-32 bg-white border rounded shadow z-10"},me=["onClick"],be=["onClick"],fe=["onClick"],ve={key:0,class:"fixed inset-0 z-50 flex"},pe={class:"w-full max-w-md h-full bg-white shadow-lg p-8 relative animate-slide-in-right overflow-y-auto"},ce={class:"text-lg font-bold mb-4"},xe={class:"mb-4"},ye={class:"mb-4"},ge={class:"mb-4"},we={class:"mb-4"},Pe={class:"mb-4"},ke={class:"mb-4"},Ne={key:1},he={class:"mb-4 flex flex-col items-center"},Ce={class:"font-bold text-xl"},Ae={class:"grid grid-cols-2 gap-3 text-sm"},Fe={class:"col-span-2"},Se={key:1,class:"fixed inset-0 z-50 flex"},Ue={class:"w-full max-w-md h-full bg-white shadow-lg p-8 relative animate-slide-in-right overflow-y-auto"},Ve={class:"mb-4"},Ee={class:"mb-4"},Me={class:"mb-4"},Le={class:"mb-4"},je={class:"mb-4"},qe={class:"mb-4"};function De(F,t,N,l,p,g){return v(),f("div",null,[c(" En-tête "),e("div",W,[e("div",null,[t[18]||(t[18]=e("h2",{class:"text-xl font-bold"},"Paramètre des patients",-1)),e("div",X,[e("div",Y,[e("span",Z,n(l.totalPatients),1),_(l.User,{class:"w-6 h-6 text-blue-500"})])])]),e("div",$,[d(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>l.search=s),type:"text",placeholder:"Rechercher un patient",class:"px-4 py-2 border rounded-md"},null,512),[[u,l.search]])])]),c(" Tableau des patients "),e("div",ee,[t[21]||(t[21]=e("h3",{class:"font-bold mb-4"},"Liste des patients",-1)),e("table",te,[t[20]||(t[20]=e("thead",null,[e("tr",{class:"border-b"},[e("th",{class:"py-2 px-2"},[e("input",{type:"checkbox"})]),e("th",{class:"py-2 px-2"},"Nom"),e("th",{class:"py-2 px-2"},"Prénom"),e("th",{class:"py-2 px-2"},"Téléphone"),e("th",{class:"py-2 px-2"},"Email"),e("th",{class:"py-2 px-2"},"Adress"),e("th",{class:"py-2 px-2"},"Statut"),e("th",{class:"py-2 px-2"})])],-1)),e("tbody",null,[(v(!0),f(O,null,H(l.filteredPatients,s=>{var x;return v(),f("tr",{key:s.id,class:"border-b hover:bg-gray-100"},[t[19]||(t[19]=e("td",{class:"py-2 px-2"},[e("input",{type:"checkbox"})],-1)),e("td",le,n(s.lastName),1),e("td",se,n(s.firstName),1),e("td",oe,n(s.phone),1),e("td",ne,n(s.email),1),e("td",ae,n(s.address),1),e("td",de,[e("span",{class:R(["px-3 py-1 rounded-full text-xs font-semibold",((x=s.accountStatus)==null?void 0:x.toLowerCase())==="active"?"bg-green-100 text-green-800":"bg-gray-200 text-gray-700"])},n(s.accountStatus),3)]),e("td",ie,[e("button",{onClick:y=>l.toggleMenu(s.id),class:"px-2 py-1 rounded hover:bg-gray-200"},"...",8,re),l.openMenu===s.id?(v(),f("div",ue,[e("ul",null,[e("li",{class:"px-4 py-2 hover:bg-blue-100 cursor-pointer",onClick:y=>l.voirPlus(s)},"Voir plus",8,me),e("li",{class:"px-4 py-2 hover:bg-blue-100 cursor-pointer",onClick:y=>l.modifier(s)},"Modifier",8,be),e("li",{class:"px-4 py-2 hover:bg-red-100 text-red-600 cursor-pointer",onClick:y=>l.supprimer(s)},"Supprimer",8,fe)])])):c("v-if",!0)])])}),128))])])]),c(" Panneau latéral détails/modif "),l.showDetails?(v(),f("div",ve,[e("div",{class:"flex-1 bg-black bg-opacity-40",onClick:t[1]||(t[1]=s=>l.showDetails=!1)}),e("div",pe,[e("button",{class:"absolute top-2 right-2 text-gray-500",onClick:t[2]||(t[2]=s=>l.showDetails=!1)},"×"),e("h3",ce,n(l.isEditing?"Modifier le patient":"Détails du patient"),1),l.isEditing?(v(),f("form",{key:0,onSubmit:E(l.enregistrerModif,["prevent"])},[e("div",xe,[t[22]||(t[22]=e("label",{class:"block mb-1"},"Nom",-1)),d(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>l.selectedPatient.lastName=s),type:"text",class:"w-full border rounded px-3 py-2",required:""},null,512),[[u,l.selectedPatient.lastName]])]),e("div",ye,[t[23]||(t[23]=e("label",{class:"block mb-1"},"Prénom",-1)),d(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>l.selectedPatient.firstName=s),type:"text",class:"w-full border rounded px-3 py-2",required:""},null,512),[[u,l.selectedPatient.firstName]])]),e("div",ge,[t[24]||(t[24]=e("label",{class:"block mb-1"},"Téléphone",-1)),d(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>l.selectedPatient.phone=s),type:"text",class:"w-full border rounded px-3 py-2",required:""},null,512),[[u,l.selectedPatient.phone]])]),e("div",we,[t[25]||(t[25]=e("label",{class:"block mb-1"},"Email",-1)),d(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>l.selectedPatient.email=s),type:"email",class:"w-full border rounded px-3 py-2",required:""},null,512),[[u,l.selectedPatient.email]])]),e("div",Pe,[t[26]||(t[26]=e("label",{class:"block mb-1"},"Adresse",-1)),d(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>l.selectedPatient.adresse=s),type:"text",class:"w-full border rounded px-3 py-2"},null,512),[[u,l.selectedPatient.adresse]])]),e("div",ke,[t[28]||(t[28]=e("label",{class:"block mb-1"},"Statut",-1)),d(e("select",{"onUpdate:modelValue":t[8]||(t[8]=s=>l.selectedPatient.accountStatus=s),class:"w-full border rounded px-3 py-2",required:""},[...t[27]||(t[27]=[e("option",{value:"active"},"Actif",-1),e("option",{value:"inactive"},"Inactif",-1)])],512),[[M,l.selectedPatient.accountStatus]])]),t[29]||(t[29]=e("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 font-bold w-full"}," Enregistrer ",-1))],32)):(v(),f("div",Ne,[e("div",he,[e("span",Ce,n(l.selectedPatient.lastName)+" "+n(l.selectedPatient.firstName),1)]),e("div",Ae,[e("div",null,[t[30]||(t[30]=e("b",null,"Type :",-1)),i(" "+n(l.selectedPatient.type||"-"),1)]),e("div",null,[t[31]||(t[31]=e("b",null,"Téléphone :",-1)),i(" "+n(l.selectedPatient.phone||"-"),1)]),e("div",null,[t[32]||(t[32]=e("b",null,"Email :",-1)),i(" "+n(l.selectedPatient.email||"-"),1)]),e("div",null,[t[33]||(t[33]=e("b",null,"Adresse :",-1)),i(" "+n(l.selectedPatient.address||l.selectedPatient.adresse||"-"),1)]),e("div",null,[t[34]||(t[34]=e("b",null,"Account Status :",-1)),i(" "+n(l.selectedPatient.accountStatus||"-"),1)]),e("div",null,[t[35]||(t[35]=e("b",null,"Date de naissance :",-1)),i(" "+n(l.selectedPatient.dateNaissance||"-"),1)]),e("div",null,[t[36]||(t[36]=e("b",null,"Années d'expérience :",-1)),i(" "+n(l.selectedPatient.anneeExperience||"-"),1)]),e("div",null,[t[37]||(t[37]=e("b",null,"Groupe sanguin :",-1)),i(" "+n(l.selectedPatient.groupeSanguin||"-"),1)]),e("div",null,[t[38]||(t[38]=e("b",null,"Genre :",-1)),i(" "+n(l.selectedPatient.genre||"-"),1)]),e("div",null,[t[39]||(t[39]=e("b",null,"Poids :",-1)),i(" "+n(l.selectedPatient.weight||"-"),1)]),e("div",Fe,[t[40]||(t[40]=e("b",null,"À propos :",-1)),i(" "+n(l.selectedPatient.about||"-"),1)]),e("div",null,[t[41]||(t[41]=e("b",null,"Créé le :",-1)),i(" "+n(l.selectedPatient.createdAt||"-"),1)]),e("div",null,[t[42]||(t[42]=e("b",null,"Mis à jour le :",-1)),i(" "+n(l.selectedPatient.updatedAt||"-"),1)])]),e("button",{class:"mt-4 bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 font-bold w-full",onClick:t[9]||(t[9]=s=>l.isEditing=!0)}," Modifier ")]))])])):c("v-if",!0),c(" Formulaire ajout "),l.showAddForm?(v(),f("div",Se,[e("div",{class:"flex-1 bg-black bg-opacity-40",onClick:t[10]||(t[10]=s=>l.showAddForm=!1)}),e("div",Ue,[e("button",{class:"absolute top-2 right-2 text-gray-500",onClick:t[11]||(t[11]=s=>l.showAddForm=!1)},"×"),t[51]||(t[51]=e("h3",{class:"text-lg font-bold mb-4"},"Ajouter un patient",-1)),e("form",{onSubmit:E(l.ajouterPatient,["prevent"])},[e("div",Ve,[t[43]||(t[43]=e("label",{class:"block mb-1"},"Nom",-1)),d(e("input",{"onUpdate:modelValue":t[12]||(t[12]=s=>l.addForm.lastName=s),type:"text",class:"w-full border rounded px-3 py-2",required:""},null,512),[[u,l.addForm.lastName]])]),e("div",Ee,[t[44]||(t[44]=e("label",{class:"block mb-1"},"Prénom",-1)),d(e("input",{"onUpdate:modelValue":t[13]||(t[13]=s=>l.addForm.firstName=s),type:"text",class:"w-full border rounded px-3 py-2",required:""},null,512),[[u,l.addForm.firstName]])]),e("div",Me,[t[45]||(t[45]=e("label",{class:"block mb-1"},"Téléphone",-1)),d(e("input",{"onUpdate:modelValue":t[14]||(t[14]=s=>l.addForm.phone=s),type:"text",class:"w-full border rounded px-3 py-2",required:""},null,512),[[u,l.addForm.phone]])]),e("div",Le,[t[46]||(t[46]=e("label",{class:"block mb-1"},"Email",-1)),d(e("input",{"onUpdate:modelValue":t[15]||(t[15]=s=>l.addForm.email=s),type:"email",class:"w-full border rounded px-3 py-2",required:""},null,512),[[u,l.addForm.email]])]),e("div",je,[t[47]||(t[47]=e("label",{class:"block mb-1"},"Adresse",-1)),d(e("input",{"onUpdate:modelValue":t[16]||(t[16]=s=>l.addForm.adresse=s),type:"text",class:"w-full border rounded px-3 py-2"},null,512),[[u,l.addForm.adresse]])]),e("div",qe,[t[49]||(t[49]=e("label",{class:"block mb-1"},"Statut",-1)),d(e("select",{"onUpdate:modelValue":t[17]||(t[17]=s=>l.addForm.accountStatus=s),class:"w-full border rounded px-3 py-2",required:""},[...t[48]||(t[48]=[e("option",{value:"active"},"Actif",-1),e("option",{value:"inactive"},"Inactif",-1)])],512),[[M,l.addForm.accountStatus]])]),t[50]||(t[50]=e("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 font-bold w-full"}," Ajouter ",-1))],32)])])):c("v-if",!0)])}const ze=J(Q,[["render",De],["__scopeId","data-v-17303a32"],["__file","D:/sambatechpro/masanteplus-back/inertia/pages/dashboard/GererPatients.vue"]]);export{ze as default};
