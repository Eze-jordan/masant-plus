import{c as f,m as c,e,h as z,t as a,j as i,v as u,F as B,D as O,i as E,H as M,g as d,r as b,E as C,o as S,n as v,B as H}from"./app-BhZ5XPUt.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{U as J}from"./user-Dg9xPuJv.js";import"./createLucideIcon-DQfiBf8Z.js";const K={__name:"GererPatients",props:{user:Object,users:{type:Array,required:!1,default:()=>[]}},setup(A,{expose:t}){t();const k=A,l=b(""),p=b(null),y=b(!1),s=b(null),x=b(!1),g=b(!1),N=b({firstName:"",lastName:"",phone:"",email:"",address:"",accountStatus:"active"}),m=b([...k.users]),L=C(()=>m.value.length),I=C(()=>l.value?m.value.filter(n=>{var r,P,o,U,V;return((r=n.lastName)==null?void 0:r.toLowerCase().includes(l.value.toLowerCase()))||((P=n.firstName)==null?void 0:P.toLowerCase().includes(l.value.toLowerCase()))||((o=n.phone)==null?void 0:o.toLowerCase().includes(l.value.toLowerCase()))||((U=n.email)==null?void 0:U.toLowerCase().includes(l.value.toLowerCase()))||((V=n.address)==null?void 0:V.toLowerCase().includes(l.value.toLowerCase()))}):m.value);async function w(){try{const n=await fetch("/patient");if(!n.ok)throw new Error("Erreur lors de la récupération des patients");const r=await n.json(),P=Array.isArray(r)?r:r.users||r.patients||[];m.value=P.map(o=>({...o,id:o.id,firstName:o.firstName||o.first_name||o.firstName||o.firstname||o.first,lastName:o.lastName||o.last_name||o.lastName||o.lastname||o.last,phone:o.phone||o.telephone||o.phoneNumber||o.phonenumber,email:o.email,address:o.address||o.adresse||null,accountStatus:o.accountStatus||o.account_status||(o.status?String(o.status).toUpperCase():null),status:o.status||null,type:o.type||null,profileImage:o.profileImage||o.profile_image||null,expoPushToken:o.expoPushToken||o.expo_push_token||null,roleId:o.roleId||o.role_id||null,createdAt:o.createdAt||o.created_at||null,updatedAt:o.updatedAt||o.updated_at||null,dateNaissance:o.dateNaissance||o.date_naissance||null,about:o.about||null,groupeSanguin:o.groupeSanguin||o.groupe_sanguin||null,anneeExperience:o.anneeExperience||o.annee_experience||null,genre:o.genre||null,weight:o.weight||null}))}catch(n){console.error(n)}}let h=null;S(()=>{w(),h=setInterval(()=>{w()},5e3)}),S(()=>{w()});function j(n){p.value=p.value===n?null:n}function q(n){s.value={...n},y.value=!0,x.value=!1,p.value=null}function D(n){s.value={...n},y.value=!0,x.value=!0,p.value=null}function _(n){confirm("Supprimer "+n.lastName+" ?")&&(m.value=m.value.filter(r=>r.id!==n.id)),p.value=null}function T(){const n=m.value.findIndex(r=>r.id===s.value.id);n!==-1&&(m.value[n]={...s.value}),y.value=!1}function G(){const n={...N.value,id:Date.now()};m.value.push(n),g.value=!1,N.value={firstName:"",lastName:"",phone:"",email:"",address:"",accountStatus:"active"}}const F={props:k,search:l,openMenu:p,showDetails:y,selectedPatient:s,isEditing:x,showAddForm:g,addForm:N,patients:m,totalPatients:L,filteredPatients:I,fetchPatients:w,get intervalId(){return h},set intervalId(n){h=n},toggleMenu:j,voirPlus:q,modifier:D,supprimer:_,enregistrerModif:T,ajouterPatient:G,ref:b,computed:C,onMounted:S,get User(){return J}};return Object.defineProperty(F,"__isScriptSetup",{enumerable:!1,value:!0}),F}},Q={class:"flex justify-between items-center mb-6"},W={class:"mt-2 flex items-center gap-4"},X={class:"bg-white rounded shadow p-4 flex items-center gap-2"},Y={class:"font-bold text-2xl"},Z={class:"flex items-center gap-4"},$={class:"bg-white rounded shadow p-4"},ee={class:"w-full text-left"},te={class:"py-2 px-2 font-bold"},le={class:"py-2 px-2"},se={class:"py-2 px-2"},oe={class:"py-2 px-2"},ne={class:"py-2 px-2"},ae={class:"py-2 px-2"},ie={class:"py-2 px-2 relative"},de=["onClick"],re={key:0,class:"absolute right-0 mt-2 w-32 bg-white border rounded shadow z-10"},ue=["onClick"],me=["onClick"],be=["onClick"],fe={key:0,class:"fixed inset-0 z-50 flex"},ve={class:"w-full max-w-md h-full bg-white shadow-lg p-8 relative animate-slide-in-right overflow-y-auto"},pe={class:"text-lg font-bold mb-4"},ce={class:"mb-4"},xe={class:"mb-4"},ge={class:"mb-4"},ye={class:"mb-4"},we={class:"mb-4"},Pe={class:"mb-4"},ke={key:1},Ne={class:"mb-4 flex flex-col items-center"},he={class:"font-bold text-xl"},Ce={class:"grid grid-cols-2 gap-3 text-sm"},Se={class:"col-span-2"},Ae={key:1,class:"fixed inset-0 z-50 flex"},Fe={class:"w-full max-w-md h-full bg-white shadow-lg p-8 relative animate-slide-in-right overflow-y-auto"},Ue={class:"mb-4"},Ve={class:"mb-4"},Ee={class:"mb-4"},Me={class:"mb-4"},Le={class:"mb-4"},Ie={class:"mb-4"};function je(A,t,k,l,p,y){return v(),f("div",null,[c(" En-tête "),e("div",Q,[e("div",null,[t[18]||(t[18]=e("h2",{class:"text-xl font-bold"},"Paramètre des patients",-1)),e("div",W,[e("div",X,[e("span",Y,a(l.totalPatients),1),z(l.User,{class:"w-6 h-6 text-blue-500"})])])]),e("div",Z,[i(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>l.search=s),type:"text",placeholder:"Rechercher un patient",class:"px-4 py-2 border rounded-md"},null,512),[[u,l.search]])])]),c(" Tableau des patients "),e("div",$,[t[21]||(t[21]=e("h3",{class:"font-bold mb-4"},"Liste des patients",-1)),e("table",ee,[t[20]||(t[20]=e("thead",null,[e("tr",{class:"border-b"},[e("th",{class:"py-2 px-2"},[e("input",{type:"checkbox"})]),e("th",{class:"py-2 px-2"},"Nom"),e("th",{class:"py-2 px-2"},"Prénom"),e("th",{class:"py-2 px-2"},"Téléphone"),e("th",{class:"py-2 px-2"},"Email"),e("th",{class:"py-2 px-2"},"Adress"),e("th",{class:"py-2 px-2"},"Statut"),e("th",{class:"py-2 px-2"})])],-1)),e("tbody",null,[(v(!0),f(B,null,O(l.filteredPatients,s=>{var x;return v(),f("tr",{key:s.id,class:"border-b hover:bg-gray-100"},[t[19]||(t[19]=e("td",{class:"py-2 px-2"},[e("input",{type:"checkbox"})],-1)),e("td",te,a(s.lastName),1),e("td",le,a(s.firstName),1),e("td",se,a(s.phone),1),e("td",oe,a(s.email),1),e("td",ne,a(s.address),1),e("td",ae,[e("span",{class:H(["px-3 py-1 rounded-full text-xs font-semibold",((x=s.accountStatus)==null?void 0:x.toLowerCase())==="active"?"bg-green-100 text-green-800":"bg-gray-200 text-gray-700"])},a(s.accountStatus),3)]),e("td",ie,[e("button",{onClick:g=>l.toggleMenu(s.id),class:"px-2 py-1 rounded hover:bg-gray-200"},"...",8,de),l.openMenu===s.id?(v(),f("div",re,[e("ul",null,[e("li",{class:"px-4 py-2 hover:bg-blue-100 cursor-pointer",onClick:g=>l.voirPlus(s)},"Voir plus",8,ue),e("li",{class:"px-4 py-2 hover:bg-blue-100 cursor-pointer",onClick:g=>l.modifier(s)},"Modifier",8,me),e("li",{class:"px-4 py-2 hover:bg-red-100 text-red-600 cursor-pointer",onClick:g=>l.supprimer(s)},"Supprimer",8,be)])])):c("v-if",!0)])])}),128))])])]),c(" Panneau latéral détails/modif "),l.showDetails?(v(),f("div",fe,[e("div",{class:"flex-1 bg-black bg-opacity-40",onClick:t[1]||(t[1]=s=>l.showDetails=!1)}),e("div",ve,[e("button",{class:"absolute top-2 right-2 text-gray-500",onClick:t[2]||(t[2]=s=>l.showDetails=!1)},"×"),e("h3",pe,a(l.isEditing?"Modifier le patient":"Détails du patient"),1),l.isEditing?(v(),f("form",{key:0,onSubmit:E(l.enregistrerModif,["prevent"])},[e("div",ce,[t[22]||(t[22]=e("label",{class:"block mb-1"},"Nom",-1)),i(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>l.selectedPatient.lastName=s),type:"text",class:"w-full border rounded px-3 py-2",required:""},null,512),[[u,l.selectedPatient.lastName]])]),e("div",xe,[t[23]||(t[23]=e("label",{class:"block mb-1"},"Prénom",-1)),i(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>l.selectedPatient.firstName=s),type:"text",class:"w-full border rounded px-3 py-2",required:""},null,512),[[u,l.selectedPatient.firstName]])]),e("div",ge,[t[24]||(t[24]=e("label",{class:"block mb-1"},"Téléphone",-1)),i(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>l.selectedPatient.phone=s),type:"text",class:"w-full border rounded px-3 py-2",required:""},null,512),[[u,l.selectedPatient.phone]])]),e("div",ye,[t[25]||(t[25]=e("label",{class:"block mb-1"},"Email",-1)),i(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>l.selectedPatient.email=s),type:"email",class:"w-full border rounded px-3 py-2",required:""},null,512),[[u,l.selectedPatient.email]])]),e("div",we,[t[26]||(t[26]=e("label",{class:"block mb-1"},"Adresse",-1)),i(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>l.selectedPatient.adresse=s),type:"text",class:"w-full border rounded px-3 py-2"},null,512),[[u,l.selectedPatient.adresse]])]),e("div",Pe,[t[28]||(t[28]=e("label",{class:"block mb-1"},"Statut",-1)),i(e("select",{"onUpdate:modelValue":t[8]||(t[8]=s=>l.selectedPatient.accountStatus=s),class:"w-full border rounded px-3 py-2",required:""},[...t[27]||(t[27]=[e("option",{value:"active"},"Actif",-1),e("option",{value:"inactive"},"Inactif",-1)])],512),[[M,l.selectedPatient.accountStatus]])]),t[29]||(t[29]=e("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 font-bold w-full"}," Enregistrer ",-1))],32)):(v(),f("div",ke,[e("div",Ne,[e("span",he,a(l.selectedPatient.lastName)+" "+a(l.selectedPatient.firstName),1)]),e("div",Ce,[e("div",null,[t[30]||(t[30]=e("b",null,"Type :",-1)),d(" "+a(l.selectedPatient.type||"-"),1)]),e("div",null,[t[31]||(t[31]=e("b",null,"Téléphone :",-1)),d(" "+a(l.selectedPatient.phone||"-"),1)]),e("div",null,[t[32]||(t[32]=e("b",null,"Email :",-1)),d(" "+a(l.selectedPatient.email||"-"),1)]),e("div",null,[t[33]||(t[33]=e("b",null,"Adresse :",-1)),d(" "+a(l.selectedPatient.address||l.selectedPatient.adresse||"-"),1)]),e("div",null,[t[34]||(t[34]=e("b",null,"Account Status :",-1)),d(" "+a(l.selectedPatient.accountStatus||"-"),1)]),e("div",null,[t[35]||(t[35]=e("b",null,"Date de naissance :",-1)),d(" "+a(l.selectedPatient.dateNaissance||"-"),1)]),e("div",null,[t[36]||(t[36]=e("b",null,"Années d'expérience :",-1)),d(" "+a(l.selectedPatient.anneeExperience||"-"),1)]),e("div",null,[t[37]||(t[37]=e("b",null,"Groupe sanguin :",-1)),d(" "+a(l.selectedPatient.groupeSanguin||"-"),1)]),e("div",null,[t[38]||(t[38]=e("b",null,"Genre :",-1)),d(" "+a(l.selectedPatient.genre||"-"),1)]),e("div",null,[t[39]||(t[39]=e("b",null,"Poids :",-1)),d(" "+a(l.selectedPatient.weight||"-"),1)]),e("div",Se,[t[40]||(t[40]=e("b",null,"À propos :",-1)),d(" "+a(l.selectedPatient.about||"-"),1)]),e("div",null,[t[41]||(t[41]=e("b",null,"Créé le :",-1)),d(" "+a(l.selectedPatient.createdAt||"-"),1)]),e("div",null,[t[42]||(t[42]=e("b",null,"Mis à jour le :",-1)),d(" "+a(l.selectedPatient.updatedAt||"-"),1)])]),e("button",{class:"mt-4 bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 font-bold w-full",onClick:t[9]||(t[9]=s=>l.isEditing=!0)}," Modifier ")]))])])):c("v-if",!0),c(" Formulaire ajout "),l.showAddForm?(v(),f("div",Ae,[e("div",{class:"flex-1 bg-black bg-opacity-40",onClick:t[10]||(t[10]=s=>l.showAddForm=!1)}),e("div",Fe,[e("button",{class:"absolute top-2 right-2 text-gray-500",onClick:t[11]||(t[11]=s=>l.showAddForm=!1)},"×"),t[51]||(t[51]=e("h3",{class:"text-lg font-bold mb-4"},"Ajouter un patient",-1)),e("form",{onSubmit:E(l.ajouterPatient,["prevent"])},[e("div",Ue,[t[43]||(t[43]=e("label",{class:"block mb-1"},"Nom",-1)),i(e("input",{"onUpdate:modelValue":t[12]||(t[12]=s=>l.addForm.lastName=s),type:"text",class:"w-full border rounded px-3 py-2",required:""},null,512),[[u,l.addForm.lastName]])]),e("div",Ve,[t[44]||(t[44]=e("label",{class:"block mb-1"},"Prénom",-1)),i(e("input",{"onUpdate:modelValue":t[13]||(t[13]=s=>l.addForm.firstName=s),type:"text",class:"w-full border rounded px-3 py-2",required:""},null,512),[[u,l.addForm.firstName]])]),e("div",Ee,[t[45]||(t[45]=e("label",{class:"block mb-1"},"Téléphone",-1)),i(e("input",{"onUpdate:modelValue":t[14]||(t[14]=s=>l.addForm.phone=s),type:"text",class:"w-full border rounded px-3 py-2",required:""},null,512),[[u,l.addForm.phone]])]),e("div",Me,[t[46]||(t[46]=e("label",{class:"block mb-1"},"Email",-1)),i(e("input",{"onUpdate:modelValue":t[15]||(t[15]=s=>l.addForm.email=s),type:"email",class:"w-full border rounded px-3 py-2",required:""},null,512),[[u,l.addForm.email]])]),e("div",Le,[t[47]||(t[47]=e("label",{class:"block mb-1"},"Adresse",-1)),i(e("input",{"onUpdate:modelValue":t[16]||(t[16]=s=>l.addForm.adresse=s),type:"text",class:"w-full border rounded px-3 py-2"},null,512),[[u,l.addForm.adresse]])]),e("div",Ie,[t[49]||(t[49]=e("label",{class:"block mb-1"},"Statut",-1)),i(e("select",{"onUpdate:modelValue":t[17]||(t[17]=s=>l.addForm.accountStatus=s),class:"w-full border rounded px-3 py-2",required:""},[...t[48]||(t[48]=[e("option",{value:"active"},"Actif",-1),e("option",{value:"inactive"},"Inactif",-1)])],512),[[M,l.addForm.accountStatus]])]),t[50]||(t[50]=e("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 font-bold w-full"}," Ajouter ",-1))],32)])])):c("v-if",!0)])}const Ge=R(K,[["render",je],["__scopeId","data-v-17303a32"],["__file","D:/sambatechpro/masanteplus-back/inertia/pages/dashboard/GererPatients.vue"]]);export{Ge as default};
