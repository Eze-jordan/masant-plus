import{c as u,m as d,e,h as j,t as r,j as I,v as N,F as P,D as V,g as b,r as p,E as _,o as k,n as m,B as O}from"./app-CAn8e8WT.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{c as B}from"./createLucideIcon-C-WkQ_Z3.js";/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=B("stethoscope",[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]]),C="/ListeDemande",F={__name:"ListeDemande",setup(L,{expose:o}){o();const i=p(""),s=p([]),f=p(!1),x=p(null),n=_(()=>s.value.length),h=_(()=>i.value?s.value.filter(l=>{var a,c,t,w,D;return((a=l.nom)==null?void 0:a.toLowerCase().includes(i.value.toLowerCase()))||((c=l.prenom)==null?void 0:c.toLowerCase().includes(i.value.toLowerCase()))||((t=l.email)==null?void 0:t.toLowerCase().includes(i.value.toLowerCase()))||((w=l.specialite)==null?void 0:w.toLowerCase().includes(i.value.toLowerCase()))||((D=l.matricule)==null?void 0:D.toLowerCase().includes(i.value.toLowerCase()))}):s.value);async function y(){try{const l=await fetch(C);if(!l.ok)throw new Error("Erreur de récupération des données");const a=await l.json(),c=Array.isArray(a)?a:a.demandes||[];s.value=c.map(t=>({...t,id:t.id,nom:t.firstName||t.first_name||t.nom,prenom:t.lastName||t.last_name||t.prenom,telephone:t.phone||t.telephone,specialite:t.specialisation||t.speciality||t.specialite,matricule:t.licenseNumber||t.license_number,status:t.status||"pending",type:t.type||null,profileImage:t.profileImage||t.profile_image||null,accountStatus:t.accountStatus||t.account_status||null,expoPushToken:t.expoPushToken||t.expo_push_token||null,address:t.address||null,roleId:t.roleId||t.role_id||null,createdAt:t.createdAt||t.created_at||null,updatedAt:t.updatedAt||t.updated_at||null,dateNaissance:t.dateNaissance||t.date_naissance||null,about:t.about||null,groupeSanguin:t.groupeSanguin||t.groupe_sanguin||null,anneeExperience:t.anneeExperience||t.annee_experience||null,genre:t.genre||null,weight:t.weight||null}))}catch(l){console.error("Erreur API:",l)}}k(y);async function S(l){try{if(!(await fetch(`/demandes-docteurs/approve/${l.id}`,{method:"POST",headers:{"Content-Type":"application/json","x-app-key":"boulinguiboulingui"}})).ok)throw new Error("Erreur lors de l'approbation");alert("Demande approuvée pour "+l.nom),s.value=s.value.filter(c=>c.id!==l.id),f.value=!1}catch(a){console.error(a),alert("Erreur lors de l'approbation de la demande.")}}async function E(l){try{if(!(await fetch(`/demandes-docteurs/reject/${l.id}`,{method:"POST",headers:{"Content-Type":"application/json","x-app-key":"boulinguiboulingui"}})).ok)throw new Error("Erreur lors du refus");alert("Demande refusée pour "+l.nom),s.value=s.value.filter(c=>c.id!==l.id),f.value=!1}catch(a){console.error(a),alert("Erreur lors du refus de la demande.")}}function M(l){x.value=l,f.value=!0}const v=p(null);function A(l){v.value=v.value===l?null:l}function T(l){if(!l)return"bg-yellow-100 text-yellow-800";const a=String(l).toLowerCase();return a==="approved"?"bg-green-100 text-green-800":a==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}const g={search:i,demandes:s,showDetails:f,selectedDemande:x,totalDemandes:n,filteredDemandes:h,API_URL:C,fetchDemandes:y,accepterDemande:S,refuserDemande:E,voirDetails:M,openMenuId:v,toggleMenu:A,statusClass:T,ref:p,computed:_,onMounted:k,get Stethoscope(){return R}};return Object.defineProperty(g,"__isScriptSetup",{enumerable:!1,value:!0}),g}},U={class:"flex justify-between items-center mb-6"},q={class:"mt-2 flex items-center gap-4"},H={class:"bg-white rounded shadow p-4 flex items-center gap-2"},G={class:"font-bold text-2xl"},J={class:"flex items-center gap-4"},K={class:"bg-white rounded shadow p-4"},Q={class:"w-full text-left"},W={class:"py-2 px-2 flex items-center gap-2"},X={class:"font-bold"},Y={class:"py-2 px-2"},Z={class:"py-2 px-2"},$={class:"py-2 px-2"},ee={class:"py-2 px-2"},te={class:"py-2 px-2"},se={class:"py-2 px-2"},oe={class:"py-2 px-2 relative"},le={class:"flex items-center"},ne=["onClick"],ae={key:0,class:"absolute right-0 mt-2 w-40 bg-white border rounded shadow-md z-50"},re=["onClick"],ie=["onClick"],ce=["onClick"],de={key:0,class:"fixed inset-0 z-50 flex"},ue={class:"w-full max-w-md h-full bg-white shadow-lg p-8 relative animate-slide-in-right overflow-y-auto"},pe={key:0},me={class:"mb-4 flex flex-col items-center"},fe={class:"font-bold text-xl"},he={class:"mb-2"},be={class:"mb-2"},xe={class:"mb-2"},ve={class:"mb-2"},_e={class:"flex gap-4 mt-6"};function ye(L,o,i,s,f,x){return m(),u("div",null,[d(" En-tête "),e("div",U,[e("div",null,[o[5]||(o[5]=e("h2",{class:"text-xl font-bold"},"Paramètre des médecins",-1)),e("div",q,[e("div",H,[e("span",G,r(s.totalDemandes),1),j(s.Stethoscope,{class:"w-6 h-6 text-blue-500"})])])]),e("div",J,[I(e("input",{"onUpdate:modelValue":o[0]||(o[0]=n=>s.search=n),type:"text",placeholder:"Rechercher un Docteur par Matricule, nom, etc.",class:"px-4 py-2 border rounded-md"},null,512),[[N,s.search]]),o[6]||(o[6]=e("button",{class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 font-bold"}," + Ajouter un Docteur ",-1))])]),d(" Tableau des demandes "),e("div",K,[o[9]||(o[9]=e("h3",{class:"font-bold mb-4"},"Liste des demandes de compte",-1)),e("table",Q,[o[8]||(o[8]=e("thead",null,[e("tr",{class:"border-b"},[e("th",{class:"py-2 px-2"},[e("input",{type:"checkbox"})]),e("th",{class:"py-2 px-2"},"Nom"),e("th",{class:"py-2 px-2"},"Prénom"),e("th",{class:"py-2 px-2"},"Téléphone"),e("th",{class:"py-2 px-2"},"Email"),e("th",{class:"py-2 px-2"},"Spécialité"),e("th",{class:"py-2 px-2"},"Matricule"),e("th",{class:"py-2 px-2"},"Statut"),e("th",{class:"py-2 px-2"},"Actions")])],-1)),e("tbody",null,[(m(!0),u(P,null,V(s.filteredDemandes,n=>(m(),u("tr",{key:n.id,class:"border-b hover:bg-gray-100"},[o[7]||(o[7]=e("td",{class:"py-2 px-2"},[e("input",{type:"checkbox"})],-1)),e("td",W,[e("span",X,"Dr. "+r(n.nom),1)]),e("td",Y,r(n.prenom),1),e("td",Z,r(n.telephone),1),e("td",$,r(n.email),1),e("td",ee,r(n.specialite),1),e("td",te,r(n.matricule),1),e("td",se,[e("span",{class:O(["px-2 py-1 rounded-full text-sm",s.statusClass(n.status)])},r(n.status||"pending"),3)]),e("td",oe,[e("div",le,[e("button",{onClick:h=>s.toggleMenu(n.id),class:"text-xl font-bold px-2"},"⋯",8,ne)]),d(" Inline menu "),s.openMenuId===n.id?(m(),u("div",ae,[e("button",{onClick:h=>s.accepterDemande(n),class:"w-full text-left px-4 py-2 hover:bg-green-50"},"Approuver",8,re),e("button",{onClick:h=>s.refuserDemande(n),class:"w-full text-left px-4 py-2 hover:bg-red-50"},"Refuser",8,ie),e("button",{onClick:h=>s.voirDetails(n),class:"w-full text-left px-4 py-2 hover:bg-gray-50"},"Voir détails",8,ce)])):d("v-if",!0)])]))),128))])])]),d(" Détails "),s.showDetails?(m(),u("div",de,[e("div",{class:"flex-1 bg-black bg-opacity-40",onClick:o[1]||(o[1]=n=>s.showDetails=!1)}),e("div",ue,[e("button",{class:"absolute top-2 right-2 text-gray-500",onClick:o[2]||(o[2]=n=>s.showDetails=!1)},"×"),o[14]||(o[14]=e("h3",{class:"text-lg font-bold mb-4"},"Détails de la demande",-1)),s.selectedDemande?(m(),u("div",pe,[e("div",me,[e("span",fe,"Dr. "+r(s.selectedDemande.nom)+" "+r(s.selectedDemande.prenom),1)]),e("div",he,[o[10]||(o[10]=e("b",null,"Téléphone :",-1)),b(" "+r(s.selectedDemande.telephone),1)]),e("div",be,[o[11]||(o[11]=e("b",null,"Email :",-1)),b(" "+r(s.selectedDemande.email),1)]),e("div",xe,[o[12]||(o[12]=e("b",null,"Spécialité :",-1)),b(" "+r(s.selectedDemande.specialite),1)]),e("div",ve,[o[13]||(o[13]=e("b",null,"Matricule :",-1)),b(" "+r(s.selectedDemande.matricule),1)]),e("div",_e,[e("button",{class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 font-bold flex-1",onClick:o[3]||(o[3]=n=>s.accepterDemande(s.selectedDemande))},"Approuver"),e("button",{class:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 font-bold flex-1",onClick:o[4]||(o[4]=n=>s.refuserDemande(s.selectedDemande))},"Refuser")])])):d("v-if",!0)])])):d("v-if",!0)])}const ge=z(F,[["render",ye],["__scopeId","data-v-84dc542b"],["__file","D:/sambatechpro/masanteplus-back/inertia/pages/dashboard/ListeDemande.vue"]]),Ce=Object.freeze(Object.defineProperty({__proto__:null,default:ge},Symbol.toStringTag,{value:"Module"}));export{ge as L,R as S,Ce as a};
