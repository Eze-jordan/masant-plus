import{c as u,m as d,e,h as P,t as r,j as V,v as O,F as z,D as B,g as x,r as p,E as y,o as C,u as L,n as m,B as R}from"./app-CaZ2Mw_6.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{c as F}from"./createLucideIcon-nmpOFqC6.js";/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=F("stethoscope",[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]]),S="/ListeDemande",H={__name:"ListeDemande",setup(E,{expose:o}){o();const c=p(""),s=p([]),f=p(!1),v=p(null),n=p(null),h=y(()=>s.value.length),I=y(()=>{const l=s.value.filter(a=>{const i=(a.status||"").toLowerCase();return i==="pending"||i==="rejected"});return c.value?l.filter(a=>{var i,t,w,D,k;return((i=a.nom)==null?void 0:i.toLowerCase().includes(c.value.toLowerCase()))||((t=a.prenom)==null?void 0:t.toLowerCase().includes(c.value.toLowerCase()))||((w=a.email)==null?void 0:w.toLowerCase().includes(c.value.toLowerCase()))||((D=a.specialite)==null?void 0:D.toLowerCase().includes(c.value.toLowerCase()))||((k=a.matricule)==null?void 0:k.toLowerCase().includes(c.value.toLowerCase()))}):l});async function _(){try{const l=await fetch(S);if(!l.ok)throw new Error("Erreur de récupération des données");const a=await l.json(),i=Array.isArray(a)?a:a.demandes||[];s.value=i.map(t=>({...t,id:t.id,nom:t.firstName||t.first_name||t.nom,prenom:t.lastName||t.last_name||t.prenom,telephone:t.phone||t.telephone,specialite:t.specialisation||t.speciality||t.specialite,matricule:t.licenseNumber||t.license_number,status:t.status||"pending",type:t.type||null,profileImage:t.profileImage||t.profile_image||null,accountStatus:t.accountStatus||t.account_status||null,expoPushToken:t.expoPushToken||t.expo_push_token||null,address:t.address||null,roleId:t.roleId||t.role_id||null,createdAt:t.createdAt||t.created_at||null,updatedAt:t.updatedAt||t.updated_at||null,dateNaissance:t.dateNaissance||t.date_naissance||null,about:t.about||null,groupeSanguin:t.groupeSanguin||t.groupe_sanguin||null,anneeExperience:t.anneeExperience||t.annee_experience||null,genre:t.genre||null,weight:t.weight||null}))}catch(l){console.error("Erreur API:",l)}}let b=null;C(()=>{_(),b=setInterval(()=>{_()},15e3)}),L(()=>{b&&clearInterval(b)});async function M(l){try{if(!(await fetch(`/demandes-docteurs/approve/${l.id}`,{method:"POST",headers:{"Content-Type":"application/json","x-app-key":"boulinguiboulingui"}})).ok)throw new Error("Erreur lors de l'approbation");alert("Demande approuvée pour "+l.nom),s.value=s.value.filter(i=>i.id!==l.id),f.value=!1}catch(a){console.error(a),alert("Erreur lors de l'approbation de la demande.")}}async function T(l){try{if(!(await fetch(`/demandes-docteurs/reject/${l.id}`,{method:"POST",headers:{"Content-Type":"application/json","x-app-key":"boulinguiboulingui"}})).ok)throw new Error("Erreur lors du refus");alert("Demande refusée pour "+l.nom),s.value=s.value.filter(i=>i.id!==l.id),f.value=!1}catch(a){console.error(a),alert("Erreur lors du refus de la demande.")}}function j(l){v.value=l,f.value=!0}function A(l){n.value=n.value===l?null:l}function N(l){if(!l)return"bg-yellow-100 text-yellow-800";const a=String(l).toLowerCase();return a==="approved"?"bg-green-100 text-green-800":a==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}const g={search:c,demandes:s,showDetails:f,selectedDemande:v,openMenuId:n,totalDemandes:h,filteredDemandes:I,API_URL:S,fetchDemandes:_,get refreshInterval(){return b},set refreshInterval(l){b=l},accepterDemande:M,refuserDemande:T,voirDetails:j,toggleMenu:A,statusClass:N,ref:p,computed:y,onMounted:C,onUnmounted:L,get Stethoscope(){return q}};return Object.defineProperty(g,"__isScriptSetup",{enumerable:!1,value:!0}),g}},G={class:"flex justify-between items-center mb-6"},J={class:"mt-2 flex items-center gap-4"},K={class:"bg-white rounded shadow p-4 flex items-center gap-2"},Q={class:"font-bold text-2xl"},W={class:"flex items-center gap-4"},X={class:"bg-white rounded shadow p-4"},Y={class:"w-full text-left"},Z={class:"py-2 px-2 flex items-center gap-2"},$={class:"font-bold"},ee={class:"py-2 px-2"},te={class:"py-2 px-2"},se={class:"py-2 px-2"},oe={class:"py-2 px-2"},le={class:"py-2 px-2"},ne={class:"py-2 px-2"},ae={class:"py-2 px-2 relative"},re={class:"flex items-center"},ie=["onClick"],ce={key:0,class:"absolute right-0 mt-2 w-40 bg-white border rounded shadow-md z-50"},de=["onClick"],ue=["onClick"],pe=["onClick"],me={key:0,class:"fixed inset-0 z-50 flex"},fe={class:"w-full max-w-md h-full bg-white shadow-lg p-8 relative animate-slide-in-right overflow-y-auto"},he={key:0},be={class:"mb-4 flex flex-col items-center"},xe={class:"font-bold text-xl"},ve={class:"mb-2"},_e={class:"mb-2"},ye={class:"mb-2"},ge={class:"mb-2"},we={class:"flex gap-4 mt-6"};function De(E,o,c,s,f,v){return m(),u("div",null,[d(" En-tête "),e("div",G,[e("div",null,[o[5]||(o[5]=e("h2",{class:"text-xl font-bold"},"Paramètre des médecins",-1)),e("div",J,[e("div",K,[e("span",Q,r(s.totalDemandes),1),P(s.Stethoscope,{class:"w-6 h-6 text-blue-500"})])])]),e("div",W,[V(e("input",{"onUpdate:modelValue":o[0]||(o[0]=n=>s.search=n),type:"text",placeholder:"Rechercher un Docteur par Matricule, nom, etc.",class:"px-4 py-2 border rounded-md"},null,512),[[O,s.search]])])]),d(" Tableau des demandes "),e("div",X,[o[8]||(o[8]=e("h3",{class:"font-bold mb-4"},"Liste des demandes de compte",-1)),e("table",Y,[o[7]||(o[7]=e("thead",null,[e("tr",{class:"border-b"},[e("th",{class:"py-2 px-2"},[e("input",{type:"checkbox"})]),e("th",{class:"py-2 px-2"},"Nom"),e("th",{class:"py-2 px-2"},"Prénom"),e("th",{class:"py-2 px-2"},"Téléphone"),e("th",{class:"py-2 px-2"},"Email"),e("th",{class:"py-2 px-2"},"Spécialité"),e("th",{class:"py-2 px-2"},"Matricule"),e("th",{class:"py-2 px-2"},"Statut"),e("th",{class:"py-2 px-2"},"Actions")])],-1)),e("tbody",null,[(m(!0),u(z,null,B(s.filteredDemandes,n=>(m(),u("tr",{key:n.id,class:"border-b hover:bg-gray-100"},[o[6]||(o[6]=e("td",{class:"py-2 px-2"},[e("input",{type:"checkbox"})],-1)),e("td",Z,[e("span",$,"Dr. "+r(n.nom),1)]),e("td",ee,r(n.prenom),1),e("td",te,r(n.telephone),1),e("td",se,r(n.email),1),e("td",oe,r(n.specialite),1),e("td",le,r(n.matricule),1),e("td",ne,[e("span",{class:R(["px-2 py-1 rounded-full text-sm",s.statusClass(n.status)])},r(n.status||"pending"),3)]),e("td",ae,[e("div",re,[e("button",{onClick:h=>s.toggleMenu(n.id),class:"text-xl font-bold px-2"},"⋯",8,ie)]),d(" Inline menu "),s.openMenuId===n.id?(m(),u("div",ce,[e("button",{onClick:h=>s.accepterDemande(n),class:"w-full text-left px-4 py-2 hover:bg-green-50"},"Approuver",8,de),e("button",{onClick:h=>s.refuserDemande(n),class:"w-full text-left px-4 py-2 hover:bg-red-50"},"Refuser",8,ue),e("button",{onClick:h=>s.voirDetails(n),class:"w-full text-left px-4 py-2 hover:bg-gray-50"},"Voir détails",8,pe)])):d("v-if",!0)])]))),128))])])]),d(" Détails "),s.showDetails?(m(),u("div",me,[e("div",{class:"flex-1 bg-black bg-opacity-40",onClick:o[1]||(o[1]=n=>s.showDetails=!1)}),e("div",fe,[e("button",{class:"absolute top-2 right-2 text-gray-500",onClick:o[2]||(o[2]=n=>s.showDetails=!1)},"×"),o[13]||(o[13]=e("h3",{class:"text-lg font-bold mb-4"},"Détails de la demande",-1)),s.selectedDemande?(m(),u("div",he,[e("div",be,[e("span",xe,"Dr. "+r(s.selectedDemande.nom)+" "+r(s.selectedDemande.prenom),1)]),e("div",ve,[o[9]||(o[9]=e("b",null,"Téléphone :",-1)),x(" "+r(s.selectedDemande.telephone),1)]),e("div",_e,[o[10]||(o[10]=e("b",null,"Email :",-1)),x(" "+r(s.selectedDemande.email),1)]),e("div",ye,[o[11]||(o[11]=e("b",null,"Spécialité :",-1)),x(" "+r(s.selectedDemande.specialite),1)]),e("div",ge,[o[12]||(o[12]=e("b",null,"Matricule :",-1)),x(" "+r(s.selectedDemande.matricule),1)]),e("div",we,[e("button",{class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 font-bold flex-1",onClick:o[3]||(o[3]=n=>s.accepterDemande(s.selectedDemande))},"Approuver"),e("button",{class:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 font-bold flex-1",onClick:o[4]||(o[4]=n=>s.refuserDemande(s.selectedDemande))},"Refuser")])])):d("v-if",!0)])])):d("v-if",!0)])}const ke=U(H,[["render",De],["__scopeId","data-v-84dc542b"],["__file","D:/sambatechpro/masanteplus-back/inertia/pages/dashboard/ListeDemande.vue"]]),Ee=Object.freeze(Object.defineProperty({__proto__:null,default:ke},Symbol.toStringTag,{value:"Module"}));export{ke as L,q as S,Ee as a};
